<dialog id="course-dialog" class="p-6 space-y-4 rounded-xl shadow-lg max-w-xl bg-white">
    <div class="rounded-t space-y-1 pb-2">
        <h1 class="text-lg font-semibold text-gray-800">Course Details</h1>
        <p class="text-xs text-gray-500">Additional course information (check with your advisor)</p>
    </div>

    <div id="course-dialog-close"
         class="absolute top-0 right-4 p-1.5 hover:bg-gray-100 rounded-full transition-all cursor-pointer">
        <i data-lucide="x" class="size-5 text-gray-500"/>
    </div>

    <div class="course-dialog-content flex flex-col sm:flex-row gap-6">
        <!-- Course Info -->
        <div class="border-gray-200 w-full space-y-3">
            <div class="space-y-3">
                <div class="flex justify-between gap-6 border-gray-100">
                    <div class="flex flex-col">
                        <span class="text-xs text-gray-500">Code</span>
                        <span id="course-code" class="font-medium text-gray-800"></span>
                    </div>
                    <div class="flex flex-col">
                        <span class="text-xs text-gray-500">Name</span>
                        <span id="course-name" class="font-medium"></span>
                    </div>
                </div>
                <div class="flex justify-between gap-6 pt-2 border-t border-gray-100">
                    <div class="flex flex-col">
                        <span class="text-xs text-gray-500">Credit Hours</span>
                        <span class="font-medium"><span id="course-credits"></span> Cr.</span>
                    </div>
                    <div class="flex flex-col">
                        <span class="text-xs text-gray-500">ECTS</span>
                        <span class="font-medium"><span id="course-ects"></span> Cr.</span>
                    </div>
                </div>
                <div class="flex flex-col pt-2 border-t border-gray-100">
                    <span class="text-xs text-gray-500">Teaching Method</span>
                    <div class="flex gap-2 text-xs mt-1.5">
                        <span id="f2f-chip"
                              class="text-nowrap px-2 py-1 rounded transition-colors duration-200 bg-gray-100 text-gray-500">
                            F2F: Face-to-face
                        </span>
                            <span id="bld-chip"
                                  class="text-nowrap px-2 py-1 rounded transition-colors duration-200 bg-gray-100 text-gray-500">
                            BLD: Blended
                        </span>
                            <span id="ol-chip"
                                  class="text-nowrap px-2 py-1 rounded transition-colors duration-200 bg-gray-100 text-gray-500">
                            OL: Online
                        </span>
                    </div>
                    <span id="course-type" class="hidden"></span>
                </div>
            </div>
        </div>

        <!-- Contact Hours -->
        <div class="w-full sm:w-72">
            <div class="rounded-lg border border-gray-200 overflow-hidden">
                <div class="bg-gray-50 p-3 text-center border-b border-gray-200">
                    <h3 class="font-medium ">Contact Hours</h3>
                </div>
                <div class="p-4 space-y-4">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="text-center">
                            <p class="text-xs text-gray-500 mb-1">Lecture</p>
                            <p id="course-lecture" class="font-medium"></p>
                        </div>
                        <div class="text-center">
                            <p class="text-xs text-gray-500 mb-1">Practical</p>
                            <p id="course-practical" class="font-medium"></p>
                        </div>
                    </div>
                    <div class="pt-3 text-center border-t border-gray-200">
                        <p class="text-xs text-gray-500 mb-1">Total Hours/Week</p>
                        <p class="font-medium"><span id="course-total"></span> Hrs</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

</dialog>

<script>
    import type { Course } from "../types";
        import { createIcons, X } from "lucide";

        createIcons({
            icons: {
                X
                }
            });

        const dialog = document.getElementById('course-dialog') as HTMLDialogElement;

        declare global {
            interface Window {
                showCourseDialog: (course: Course) => void;
                }
            }

        function showCourseDialog(course: any) {
            const content = dialog.querySelector('.course-dialog-content') as HTMLElement;

            // Reset all chips to default state
            const f2fChip = content.querySelector('#f2f-chip') as HTMLElement;
            const bldChip = content.querySelector('#bld-chip') as HTMLElement;
            const olChip = content.querySelector('#ol-chip') as HTMLElement;

            f2fChip.className = 'px-2 py-1 rounded transition-colors duration-200 bg-gray-100 text-gray-500';
            bldChip.className = 'px-2 py-1 rounded transition-colors duration-200 bg-gray-100 text-gray-500';
            olChip.className = 'px-2 py-1 rounded transition-colors duration-200 bg-gray-100 text-gray-500';

            // Highlight the relevant chip
            switch(course.type.toUpperCase()) {
                case 'F2F':
                    f2fChip.className = 'px-2 py-1 rounded transition-colors duration-200 bg-blue-100 text-blue-700 font-medium';
                    break;
                case 'BLD':
                    bldChip.className = 'px-2 py-1 rounded transition-colors duration-200 bg-blue-100 text-blue-700 font-medium';
                    break;
                case 'OL':
                    olChip.className = 'px-2 py-1 rounded transition-colors duration-200 bg-blue-100 text-blue-700 font-medium';
                    break;
                }

            // Rest of the content setting remains same
            content.querySelector('#course-code')!.textContent = course.code;
            content.querySelector('#course-name')!.textContent = course.name;
            content.querySelector('#course-credits')!.textContent = course.creditHours;
            content.querySelector('#course-ects')!.textContent = course.ects;
            content.querySelector('#course-type')!.textContent = course.type;
            content.querySelector('#course-lecture')!.textContent = `${course.lectureHours} Hr.`;
            content.querySelector('#course-practical')!.textContent = `${course.practicalHours} Hr.`;
            content.querySelector('#course-total')!.textContent = course.lectureHours + course.practicalHours;

            dialog.showModal();
            }

        window.showCourseDialog = showCourseDialog;

        // Close on click outside
        dialog.addEventListener('click', (e) => {
            const dialogDimensions = dialog.getBoundingClientRect();
            if (
                e.clientX < dialogDimensions.left ||
                    e.clientX > dialogDimensions.right ||
                    e.clientY < dialogDimensions.top ||
                    e.clientY > dialogDimensions.bottom
                ) {
                dialog.close();
                }
            });

        dialog.querySelector('#course-dialog-close')?.addEventListener('click', () => {
            dialog.close();
            });
</script>